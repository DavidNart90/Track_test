{
  "error_id": "20250725_191849_c1810ce7",
  "timestamp": "2025-07-25T19:18:49.257094+00:00",
  "error_type": "TypeError",
  "error_message": "Logger._log() got an unexpected keyword argument 'error'",
  "traceback": "Traceback (most recent call last):\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\src\\trackrealties\\data\\database_integration.py\", line 168, in save_property_to_database\n    property_id = await self._save_property_listing(conn, property_data)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\src\\trackrealties\\data\\database_integration.py\", line 327, in _save_property_listing\n    result = await conn.fetchval(\n             ^^^^^^^^^^^^^^^^^^^^\n    ...<30 lines>...\n    )\n    ^\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\venv\\Lib\\site-packages\\asyncpg\\connection.py\", line 714, in fetchval\n    data = await self._execute(query, args, 1, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\venv\\Lib\\site-packages\\asyncpg\\connection.py\", line 1864, in _execute\n    result, _ = await self.__execute(\n                ^^^^^^^^^^^^^^^^^^^^^\n    ...<7 lines>...\n    )\n    ^\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\venv\\Lib\\site-packages\\asyncpg\\connection.py\", line 1961, in __execute\n    result, stmt = await self._do_execute(\n                   ^^^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n    )\n    ^\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\venv\\Lib\\site-packages\\asyncpg\\connection.py\", line 2027, in _do_execute\n    result = await executor(stmt, timeout)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint \"property_listings_pkey\"\nDETAIL:  Key (id)=(7-W-21st-St,-Apt-1906,-New-York,-NY-10010) already exists.\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\src\\trackrealties\\data\\enhanced_ingestion_pipeline.py\", line 250, in ingest_property_listings\n    db_result = await self.db_integration.save_property_to_database(\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        record, chunks\n        ^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\david\\OneDrive\\Desktop\\Enhanced Embedding\\Track_test\\src\\trackrealties\\data\\database_integration.py\", line 194, in save_property_to_database\n    self.logger.error(\"Failed to save property listing\", error=str(e), **context)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"c:\\python313\\Lib\\logging\\__init__.py\", line 1548, in error\n    self._log(ERROR, msg, args, **kwargs)\n    ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: Logger._log() got an unexpected keyword argument 'error'\n",
  "context": {
    "source": "sample_data",
    "record": {
      "id": "7-W-21st-St,-Apt-1906,-New-York,-NY-10010",
      "formattedAddress": "7 W 21st St, Apt 1906, New York, NY 10010",
      "addressLine1": "7 W 21st St",
      "addressLine2": "Apt 1906",
      "city": "New York",
      "state": "NY",
      "zipCode": "10010",
      "county": "New York",
      "latitude": 40.740943,
      "longitude": -73.991128,
      "propertyType": "Apartment",
      "bedrooms": 2,
      "bathrooms": 2,
      "squareFootage": 900,
      "status": "Active",
      "price": 12138,
      "listingType": "Standard",
      "listedDate": "2023-10-27T00:00:00.000Z",
      "removedDate": null,
      "createdDate": "2019-06-20T15:22:40.103Z",
      "lastSeenDate": "2025-07-16T05:18:15.155Z",
      "daysOnMarket": 629,
      "history": {
        "2023-10-27": {
          "event": "Rental Listing",
          "price": 12138,
          "listingType": "Standard",
          "listedDate": "2023-10-27T00:00:00.000Z",
          "removedDate": null,
          "daysOnMarket": 629
        }
      }
    }
  }
}